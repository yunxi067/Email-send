# ðŸ’» ä¸ªäººè™šæ‹Ÿæœºéƒ¨ç½²æŒ‡å—

> é€‚åˆåœ¨VMwareã€VirtualBoxã€Hyper-Vç­‰è™šæ‹ŸæœºçŽ¯å¢ƒä¸­éƒ¨ç½²

## ðŸŽ¯ è™šæ‹Ÿæœºéƒ¨ç½²ä¼˜åŠ¿

- ðŸ’° **é›¶æˆæœ¬** - ä½¿ç”¨çŽ°æœ‰ç”µè„‘èµ„æº
- ðŸ”’ **å®Œå…¨æŽ§åˆ¶** - æ•°æ®åœ¨æœ¬åœ°ï¼Œå®‰å…¨å¯æŽ§
- ðŸ”„ **æ˜“äºŽå¤‡ä»½** - è™šæ‹Ÿæœºå¿«ç…§ï¼Œéšæ—¶å›žæ»š
- ðŸ“¦ **çŽ¯å¢ƒéš”ç¦»** - ä¸å½±å“ä¸»æœºç³»ç»Ÿ

## ðŸ“‹ éƒ¨ç½²æ–¹æ¡ˆé€‰æ‹©

### æ–¹æ¡ˆå¯¹æ¯”

| è™šæ‹Ÿæœºè½¯ä»¶ | å…è´¹ | æ€§èƒ½ | æ˜“ç”¨æ€§ | æŽ¨èæŒ‡æ•° |
|-----------|------|------|--------|----------|
| **VirtualBox** | âœ… | â­â­â­ | â­â­â­â­ | â­â­â­â­â­ |
| **VMware Workstation** | âŒ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| **Hyper-V** (Windows) | âœ… | â­â­â­â­ | â­â­â­ | â­â­â­ |
| **VMware Player** | âœ… | â­â­â­â­ | â­â­â­ | â­â­â­â­ |

## ðŸš€ å¿«é€Ÿéƒ¨ç½²æ­¥éª¤ï¼ˆæŽ¨èVirtualBoxï¼‰

### ç¬¬1æ­¥ï¼šå®‰è£…è™šæ‹Ÿæœºè½¯ä»¶

#### Windowsç”¨æˆ·
1. ä¸‹è½½ [VirtualBox](https://www.virtualbox.org/wiki/Downloads)
2. åŒå‡»å®‰è£…ï¼Œä¸€è·¯Nextå³å¯

#### Macç”¨æˆ·
```bash
# ä½¿ç”¨Homebrewå®‰è£…
brew install --cask virtualbox
```

### ç¬¬2æ­¥ï¼šåˆ›å»ºè™šæ‹Ÿæœº

#### æŽ¨èé…ç½®
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04 LTS Serverï¼ˆè½»é‡ï¼Œç¨³å®šï¼‰
- **CPU**: 1-2æ ¸
- **å†…å­˜**: 2GBï¼ˆæœ€å°‘1GBï¼‰
- **ç¡¬ç›˜**: 20GB
- **ç½‘ç»œ**: æ¡¥æŽ¥æ¨¡å¼ï¼ˆå±€åŸŸç½‘å¯è®¿é—®ï¼‰æˆ–NAT+ç«¯å£è½¬å‘

#### åˆ›å»ºæ­¥éª¤
1. æ‰“å¼€VirtualBoxï¼Œç‚¹å‡»"æ–°å»º"
2. åç§°ï¼š`EmailSender`
3. ç±»åž‹ï¼šLinux
4. ç‰ˆæœ¬ï¼šUbuntu (64-bit)
5. å†…å­˜ï¼š2048MB
6. åˆ›å»ºè™šæ‹Ÿç¡¬ç›˜ï¼ˆVDIï¼ŒåŠ¨æ€åˆ†é…ï¼Œ20GBï¼‰

### ç¬¬3æ­¥ï¼šå®‰è£…Ubuntu Server

1. **ä¸‹è½½Ubuntu Serveré•œåƒ**
   - [Ubuntu 20.04 Server](https://ubuntu.com/download/server)
   - é€‰æ‹©Ubuntu Server 20.04.6 LTS

2. **æŒ‚è½½ISOå¹¶å¯åŠ¨**
   - è™šæ‹Ÿæœºè®¾ç½® â†’ å­˜å‚¨ â†’ æ·»åŠ å…‰ç›˜ â†’ é€‰æ‹©ISOæ–‡ä»¶
   - å¯åŠ¨è™šæ‹Ÿæœº

3. **å®‰è£…ç³»ç»Ÿ**ï¼ˆç®€åŒ–ç‰ˆï¼‰
   ```
   - è¯­è¨€ï¼šEnglishï¼ˆæˆ–ä¸­æ–‡ï¼‰
   - é”®ç›˜ï¼šé»˜è®¤
   - ç½‘ç»œï¼šDHCPè‡ªåŠ¨èŽ·å–
   - å­˜å‚¨ï¼šä½¿ç”¨æ•´ä¸ªç£ç›˜
   - ç”¨æˆ·åï¼šadmin
   - å¯†ç ï¼šè®¾ç½®ä¸€ä¸ªå¯†ç 
   - å®‰è£…OpenSSHï¼šâœ…ï¼ˆå‹¾é€‰ï¼‰
   ```

### ç¬¬4æ­¥ï¼šé…ç½®ç½‘ç»œè®¿é—®

#### æ–¹æ¡ˆ1ï¼šæ¡¥æŽ¥æ¨¡å¼ï¼ˆæŽ¨èï¼Œå±€åŸŸç½‘å¯è®¿é—®ï¼‰
```
VirtualBoxè®¾ç½® â†’ ç½‘ç»œ â†’ ç½‘å¡1 â†’ æ¡¥æŽ¥ç½‘å¡
```

èŽ·å–è™šæ‹ŸæœºIPï¼š
```bash
# åœ¨è™šæ‹Ÿæœºä¸­æ‰§è¡Œ
ip addr show
# è®°å½•eth0çš„IPåœ°å€ï¼Œå¦‚ï¼š192.168.1.100
```

#### æ–¹æ¡ˆ2ï¼šNAT + ç«¯å£è½¬å‘ï¼ˆä»…ä¸»æœºè®¿é—®ï¼‰
```
VirtualBoxè®¾ç½® â†’ ç½‘ç»œ â†’ ç½‘å¡1 â†’ é«˜çº§ â†’ ç«¯å£è½¬å‘
æ·»åŠ è§„åˆ™ï¼š
- åç§°ï¼šHTTP
- åè®®ï¼šTCP
- ä¸»æœºç«¯å£ï¼š8080
- å®¢æˆ·ç«¯ç«¯å£ï¼š80
```

### ç¬¬5æ­¥ï¼šSSHè¿žæŽ¥è™šæ‹Ÿæœº

```bash
# Windowsä½¿ç”¨PowerShellæˆ–cmd
# Mac/Linuxä½¿ç”¨ç»ˆç«¯
ssh admin@è™šæ‹ŸæœºIP

# ä¾‹å¦‚
ssh admin@192.168.1.100
```

## ðŸ“¦ éƒ¨ç½²é‚®ä»¶ç¾¤å‘åŠ©æ‰‹

### æ–¹æ³•1ï¼šè‡ªåŠ¨åŒ–è„šæœ¬éƒ¨ç½²ï¼ˆæŽ¨èï¼‰

SSHè¿žæŽ¥åˆ°è™šæ‹ŸæœºåŽï¼Œæ‰§è¡Œï¼š

```bash
# åˆ›å»ºéƒ¨ç½²è„šæœ¬
cat > deploy.sh << 'EOF'
#!/bin/bash

echo "=========================================="
echo "å¼€å§‹éƒ¨ç½²é‚®ä»¶ç¾¤å‘åŠ©æ‰‹..."
echo "=========================================="

# 1. æ›´æ–°ç³»ç»Ÿ
echo "[1/7] æ›´æ–°ç³»ç»ŸåŒ…..."
sudo apt update && sudo apt upgrade -y

# 2. å®‰è£…åŸºç¡€è½¯ä»¶
echo "[2/7] å®‰è£…Pythonå’ŒGit..."
sudo apt install -y python3 python3-pip git curl

# 3. å®‰è£…Node.js
echo "[3/7] å®‰è£…Node.js..."
curl -fsSL https://deb.nodesource.com/setup_16.x | sudo -E bash -
sudo apt install -y nodejs

# 4. å®‰è£…Nginx
echo "[4/7] å®‰è£…Nginx..."
sudo apt install -y nginx

# 5. åˆ›å»ºé¡¹ç›®ç›®å½•
echo "[5/7] åˆ›å»ºé¡¹ç›®ç›®å½•..."
sudo mkdir -p /opt/email-sender
cd /opt/email-sender

# 6. æç¤ºä¸Šä¼ é¡¹ç›®æ–‡ä»¶
echo "[6/7] è¯·ä¸Šä¼ é¡¹ç›®æ–‡ä»¶åˆ° /opt/email-sender"
echo "åœ¨æœ¬åœ°æ‰§è¡Œï¼š"
echo "scp -r ./é‚®ä»¶ç¾¤å‘åŠ©æ‰‹/* admin@$(hostname -I | awk '{print $1}'):/opt/email-sender/"
echo ""
echo "ä¸Šä¼ å®ŒæˆåŽæŒ‰Enterç»§ç»­..."
read

# 7. å®‰è£…ä¾èµ–å¹¶å¯åŠ¨
echo "[7/7] å®‰è£…ä¾èµ–..."
cd /opt/email-sender/backend
pip3 install -r requirements.txt
pip3 install gunicorn

cd /opt/email-sender/frontend
npm install
echo "æž„å»ºå‰ç«¯..."
npm run build

# é…ç½®Nginx
sudo tee /etc/nginx/sites-available/email-sender > /dev/null << 'NGINX'
server {
    listen 80;
    server_name _;
    
    location / {
        root /opt/email-sender/frontend/dist;
        try_files $uri $uri/ /index.html;
    }
    
    location /api {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        client_max_body_size 50M;
    }
}
NGINX

sudo ln -sf /etc/nginx/sites-available/email-sender /etc/nginx/sites-enabled/
sudo rm -f /etc/nginx/sites-enabled/default
sudo nginx -t && sudo systemctl restart nginx

# å¯åŠ¨åŽç«¯
cd /opt/email-sender/backend
nohup gunicorn -w 2 -b 127.0.0.1:5000 app:app > /var/log/email-sender.log 2>&1 &

echo "=========================================="
echo "âœ… éƒ¨ç½²å®Œæˆï¼"
echo "è®¿é—®åœ°å€ï¼šhttp://$(hostname -I | awk '{print $1}')"
echo "=========================================="
EOF

# æ‰§è¡Œéƒ¨ç½²è„šæœ¬
chmod +x deploy.sh
./deploy.sh
```

### æ–¹æ³•2ï¼šæ‰‹åŠ¨éƒ¨ç½²

#### 2.1 å®‰è£…çŽ¯å¢ƒ
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…Python
sudo apt install -y python3 python3-pip

# å®‰è£…Node.js
curl -fsSL https://deb.nodesource.com/setup_16.x | sudo -E bash -
sudo apt install -y nodejs

# å®‰è£…Nginx
sudo apt install -y nginx
```

#### 2.2 ä¸Šä¼ é¡¹ç›®æ–‡ä»¶

**åœ¨æœ¬åœ°ç”µè„‘æ‰§è¡Œ**ï¼ˆWindows PowerShellæˆ–Macç»ˆç«¯ï¼‰ï¼š
```bash
# åŽ‹ç¼©é¡¹ç›®
tar -czf email-sender.tar.gz é‚®ä»¶ç¾¤å‘åŠ©æ‰‹/

# ä¸Šä¼ åˆ°è™šæ‹Ÿæœº
scp email-sender.tar.gz admin@è™šæ‹ŸæœºIP:/home/admin/

# SSHè¿žæŽ¥åˆ°è™šæ‹Ÿæœº
ssh admin@è™šæ‹ŸæœºIP

# è§£åŽ‹æ–‡ä»¶
tar -xzf email-sender.tar.gz
sudo mv é‚®ä»¶ç¾¤å‘åŠ©æ‰‹ /opt/email-sender
```

#### 2.3 å®‰è£…ä¾èµ–
```bash
# åŽç«¯ä¾èµ–
cd /opt/email-sender/backend
pip3 install -r requirements.txt
pip3 install gunicorn

# å‰ç«¯æž„å»º
cd /opt/email-sender/frontend
npm install
npm run build
```

#### 2.4 é…ç½®Nginx
```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶
sudo nano /etc/nginx/sites-available/email-sender

# ç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š
server {
    listen 80;
    server_name _;
    
    location / {
        root /opt/email-sender/frontend/dist;
        try_files $uri $uri/ /index.html;
    }
    
    location /api {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        client_max_body_size 50M;
    }
}

# å¯ç”¨é…ç½®
sudo ln -s /etc/nginx/sites-available/email-sender /etc/nginx/sites-enabled/
sudo rm /etc/nginx/sites-enabled/default
sudo systemctl restart nginx
```

#### 2.5 å¯åŠ¨åŽç«¯
```bash
cd /opt/email-sender/backend
# ä¸´æ—¶å¯åŠ¨ï¼ˆæµ‹è¯•ï¼‰
python3 app.py

# æˆ–åŽå°å¯åŠ¨
nohup gunicorn -w 2 -b 127.0.0.1:5000 app:app &
```

## ðŸ”§ è™šæ‹Ÿæœºä¼˜åŒ–é…ç½®

### 1. è®¾ç½®é™æ€IPï¼ˆå¯é€‰ï¼‰

ç¼–è¾‘ç½‘ç»œé…ç½®ï¼š
```bash
sudo nano /etc/netplan/00-installer-config.yaml
```

```yaml
network:
  ethernets:
    enp0s3:
      dhcp4: no
      addresses:
        - 192.168.1.200/24
      gateway4: 192.168.1.1
      nameservers:
        addresses: [8.8.8.8, 8.8.4.4]
  version: 2
```

åº”ç”¨é…ç½®ï¼š
```bash
sudo netplan apply
```

### 2. åˆ›å»ºç³»ç»ŸæœåŠ¡ï¼ˆè‡ªåŠ¨å¯åŠ¨ï¼‰

```bash
# åˆ›å»ºserviceæ–‡ä»¶
sudo tee /etc/systemd/system/email-sender.service > /dev/null << 'EOF'
[Unit]
Description=Email Sender Backend
After=network.target

[Service]
Type=simple
User=admin
WorkingDirectory=/opt/email-sender/backend
ExecStart=/usr/bin/gunicorn -w 2 -b 127.0.0.1:5000 app:app
Restart=always

[Install]
WantedBy=multi-user.target
EOF

# å¯ç”¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable email-sender
sudo systemctl start email-sender
```

### 3. è™šæ‹Ÿæœºå¿«ç…§ï¼ˆæŽ¨èï¼‰

éƒ¨ç½²å®ŒæˆåŽï¼Œåˆ›å»ºå¿«ç…§ä»¥ä¾¿å›žæ»šï¼š
```
VirtualBox â†’ é€‰æ‹©è™šæ‹Ÿæœº â†’ å¿«ç…§ â†’ ç”Ÿæˆå¿«ç…§
åç§°ï¼šéƒ¨ç½²å®Œæˆ_v1.0
```

## ðŸŒ è®¿é—®æ–¹å¼

### ä»Žä¸»æœºè®¿é—®
- æ¡¥æŽ¥æ¨¡å¼ï¼š`http://è™šæ‹ŸæœºIP`ï¼ˆå¦‚ http://192.168.1.100ï¼‰
- NATæ¨¡å¼ï¼š`http://localhost:8080`ï¼ˆç«¯å£è½¬å‘ï¼‰

### ä»Žå±€åŸŸç½‘å…¶ä»–è®¾å¤‡è®¿é—®
- ä»…æ¡¥æŽ¥æ¨¡å¼æ”¯æŒ
- ç¡®ä¿é˜²ç«å¢™å…è®¸è®¿é—®

### è®¾ç½®Windows hostsï¼ˆå¯é€‰ï¼‰
```
# ç¼–è¾‘ C:\Windows\System32\drivers\etc\hosts
192.168.1.100 email.local

# ç„¶åŽå¯ä»¥è®¿é—®
http://email.local
```

## ðŸ“Š èµ„æºç›‘æŽ§

### æŸ¥çœ‹èµ„æºä½¿ç”¨
```bash
# CPUå’Œå†…å­˜
htop  # éœ€è¦å…ˆå®‰è£…ï¼šsudo apt install htop

# ç£ç›˜ç©ºé—´
df -h

# ç½‘ç»œè¿žæŽ¥
netstat -tulpn
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®
1. **å¦‚æžœè¿è¡Œç¼“æ…¢**ï¼šå¢žåŠ è™šæ‹Ÿæœºå†…å­˜åˆ°3-4GB
2. **å¦‚æžœç£ç›˜ä¸è¶³**ï¼šæ‰©å±•è™šæ‹Ÿç¡¬ç›˜
3. **å¦‚æžœç½‘ç»œå»¶è¿Ÿ**ï¼šä½¿ç”¨æ¡¥æŽ¥æ¨¡å¼è€ŒéžNAT

## ðŸ”’ å®‰å…¨å»ºè®®

### 1. é…ç½®é˜²ç«å¢™
```bash
# å®‰è£…ufw
sudo apt install ufw

# é…ç½®è§„åˆ™
sudo ufw allow 22/tcp   # SSH
sudo ufw allow 80/tcp   # HTTP
sudo ufw enable
```

### 2. é™åˆ¶SSHè®¿é—®ï¼ˆå¯é€‰ï¼‰
```bash
# åªå…è®¸ç‰¹å®šIP SSHè¿žæŽ¥
sudo nano /etc/ssh/sshd_config

# æ·»åŠ 
AllowUsers admin@192.168.1.*
```

### 3. å®šæœŸå¤‡ä»½
```bash
# å¤‡ä»½è„šæœ¬
cat > /home/admin/backup.sh << 'EOF'
#!/bin/bash
DATE=$(date +%Y%m%d)
tar -czf /home/admin/backup-$DATE.tar.gz /opt/email-sender/backend/templates /opt/email-sender/backend/uploads
echo "å¤‡ä»½å®Œæˆï¼šbackup-$DATE.tar.gz"
EOF

chmod +x /home/admin/backup.sh

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å‘¨å¤‡ä»½ï¼‰
crontab -e
# æ·»åŠ ï¼š0 2 * * 0 /home/admin/backup.sh
```

## â“ å¸¸è§é—®é¢˜

### Q1: è™šæ‹Ÿæœºæ— æ³•è”ç½‘ï¼Ÿ
```bash
# æ£€æŸ¥ç½‘ç»œæœåŠ¡
sudo systemctl status systemd-networkd
sudo systemctl restart systemd-networkd

# æ£€æŸ¥IP
ip addr show
```

### Q2: æ— æ³•SSHè¿žæŽ¥ï¼Ÿ
```bash
# åœ¨è™šæ‹Ÿæœºä¸­æ£€æŸ¥SSHæœåŠ¡
sudo systemctl status ssh
sudo systemctl start ssh

# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status
```

### Q3: å‰ç«¯é¡µé¢æ‰“ä¸å¼€ï¼Ÿ
```bash
# æ£€æŸ¥Nginx
sudo systemctl status nginx
sudo nginx -t

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

### Q4: åŽç«¯APIå¤±è´¥ï¼Ÿ
```bash
# æ£€æŸ¥åŽç«¯æœåŠ¡
sudo systemctl status email-sender
sudo journalctl -u email-sender -f

# æ‰‹åŠ¨æµ‹è¯•
curl http://localhost:5000/api/health
```

## ðŸ’¡ è¿›é˜¶æŠ€å·§

### 1. ä½¿ç”¨Vagrantè‡ªåŠ¨åŒ–
åˆ›å»º `Vagrantfile`ï¼š
```ruby
Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/focal64"
  config.vm.network "private_network", ip: "192.168.33.10"
  config.vm.provider "virtualbox" do |vb|
    vb.memory = "2048"
    vb.cpus = 2
  end
  config.vm.provision "shell", path: "deploy.sh"
end
```

### 2. å…‹éš†è™šæ‹Ÿæœºï¼ˆå¤šå®žä¾‹ï¼‰
```
VirtualBox â†’ å³é”®è™šæ‹Ÿæœº â†’ å…‹éš†
- å®Œæ•´å…‹éš†
- é‡æ–°åˆå§‹åŒ–MACåœ°å€
```

### 3. å¯¼å‡ºOVAï¼ˆåˆ†äº«ç»™å…¶ä»–äººï¼‰
```
VirtualBox â†’ æ–‡ä»¶ â†’ å¯¼å‡ºè™šæ‹Ÿç”µè„‘
- é€‰æ‹©è™šæ‹Ÿæœº
- å¯¼å‡ºä¸ºOVAæ–‡ä»¶
```

## âœ… éƒ¨ç½²å®Œæˆæ¸…å•

- [ ] è™šæ‹Ÿæœºåˆ›å»ºæˆåŠŸ
- [ ] Ubuntuç³»ç»Ÿå®‰è£…å®Œæˆ
- [ ] ç½‘ç»œé…ç½®æ­£ç¡®ï¼ˆèƒ½pingé€šï¼‰
- [ ] é¡¹ç›®æ–‡ä»¶ä¸Šä¼ å®Œæˆ
- [ ] ä¾èµ–å®‰è£…æˆåŠŸ
- [ ] Nginxé…ç½®æ­£ç¡®
- [ ] åŽç«¯æœåŠ¡è¿è¡Œæ­£å¸¸
- [ ] å‰ç«¯é¡µé¢å¯ä»¥è®¿é—®
- [ ] é‚®ä»¶å‘é€åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] åˆ›å»ºè™šæ‹Ÿæœºå¿«ç…§

## ðŸŽ‰ æ€»ç»“

è™šæ‹Ÿæœºéƒ¨ç½²æ–¹æ¡ˆç‰¹åˆ«é€‚åˆï¼š
- ðŸ  ä¸ªäººä½¿ç”¨æˆ–å°å›¢é˜Ÿå†…éƒ¨ä½¿ç”¨
- ðŸ’° é¢„ç®—æœ‰é™ï¼ˆé›¶æˆæœ¬ï¼‰
- ðŸ”’ æ•°æ®å®‰å…¨è¦æ±‚é«˜ï¼ˆæœ¬åœ°å­˜å‚¨ï¼‰
- ðŸ”„ éœ€è¦é¢‘ç¹æµ‹è¯•å’Œè°ƒæ•´

éƒ¨ç½²å®ŒæˆåŽï¼Œæ‚¨çš„é‚®ä»¶ç¾¤å‘åŠ©æ‰‹å°±å¯ä»¥åœ¨å±€åŸŸç½‘å†…ä½¿ç”¨äº†ï¼
