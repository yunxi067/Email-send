# ðŸ“¦ é‚®ä»¶ç¾¤å‘åŠ©æ‰‹éƒ¨ç½²æŒ‡å—

> é€‚ç”¨äºŽå°è§„æ¨¡éƒ¨ç½²ï¼ˆå‡ ä¸ªäººä½¿ç”¨ï¼‰çš„ç®€å•éƒ¨ç½²æ–¹æ¡ˆ

## ðŸŽ¯ éƒ¨ç½²æ–¹æ¡ˆé€‰æ‹©

### æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | æˆæœ¬ | éš¾åº¦ | é€‚ç”¨åœºæ™¯ | æŽ¨èæŒ‡æ•° |
|------|------|------|----------|----------|
| **äº‘æœåŠ¡å™¨** | ðŸ’° ä½Ž | â­â­ | è¿œç¨‹è®¿é—® | â­â­â­â­â­ |
| å…¬å¸å†…ç½‘æœåŠ¡å™¨ | ðŸ’° å…è´¹ | â­â­â­ | ä»…å†…ç½‘è®¿é—® | â­â­â­â­ |
| ä¸ªäººç”µè„‘ | ðŸ’° å…è´¹ | â­ | ä¸´æ—¶ä½¿ç”¨ | â­â­ |

## ðŸŒŸ æŽ¨èæ–¹æ¡ˆï¼šäº‘æœåŠ¡å™¨éƒ¨ç½²ï¼ˆæœ€ç®€å•ï¼‰

### 1. é€‰æ‹©äº‘æœåŠ¡å™¨

#### æŽ¨èé…ç½®ï¼ˆå¤Ÿç”¨å³å¯ï¼‰
- **CPU**: 1æ ¸
- **å†…å­˜**: 2GB
- **ç¡¬ç›˜**: 40GB
- **å¸¦å®½**: 1-3Mbps
- **ç³»ç»Ÿ**: Ubuntu 20.04 æˆ– CentOS 7

#### æœåŠ¡å•†é€‰æ‹©
- **é˜¿é‡Œäº‘è½»é‡æœåŠ¡å™¨**: 24å…ƒ/æœˆèµ·
- **è…¾è®¯äº‘è½»é‡æœåŠ¡å™¨**: 28å…ƒ/æœˆèµ·
- **åŽä¸ºäº‘**: 19å…ƒ/æœˆèµ·

### 2. æœåŠ¡å™¨åˆå§‹é…ç½®

è¿žæŽ¥åˆ°æœåŠ¡å™¨åŽï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

```bash
# 1. æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y  # Ubuntu
# æˆ–
sudo yum update -y  # CentOS

# 2. å®‰è£…å¿…è¦è½¯ä»¶
sudo apt install -y python3 python3-pip git nginx  # Ubuntu
# æˆ–
sudo yum install -y python3 python3-pip git nginx  # CentOS

# 3. å®‰è£…Node.js (ç”¨äºŽæž„å»ºå‰ç«¯)
curl -fsSL https://deb.nodesource.com/setup_16.x | sudo -E bash -
sudo apt install -y nodejs  # Ubuntu
# æˆ–
curl -sL https://rpm.nodesource.com/setup_16.x | sudo bash -
sudo yum install -y nodejs  # CentOS
```

### 3. éƒ¨ç½²é¡¹ç›®

```bash
# 1. åˆ›å»ºé¡¹ç›®ç›®å½•
sudo mkdir -p /var/www/email-sender
cd /var/www/email-sender

# 2. ä¸Šä¼ é¡¹ç›®æ–‡ä»¶
# æ–¹æ³•1: ä½¿ç”¨gitï¼ˆå¦‚æžœæœ‰ä»“åº“ï¼‰
git clone your-repository-url .

# æ–¹æ³•2: ä½¿ç”¨scpä¸Šä¼ ï¼ˆä»Žæœ¬åœ°ï¼‰
# åœ¨æœ¬åœ°æ‰§è¡Œï¼š
# scp -r ./é‚®ä»¶ç¾¤å‘åŠ©æ‰‹/* root@æœåŠ¡å™¨IP:/var/www/email-sender/

# 3. å®‰è£…åŽç«¯ä¾èµ–
cd backend
pip3 install -r requirements.txt

# 4. æž„å»ºå‰ç«¯
cd ../frontend
npm install
npm run build
```

### 4. é…ç½®ç”Ÿäº§çŽ¯å¢ƒ

#### 4.1 å®‰è£…ç”Ÿäº§æœåŠ¡å™¨
```bash
# å®‰è£…gunicornï¼ˆç”Ÿäº§çŽ¯å¢ƒçš„PythonæœåŠ¡å™¨ï¼‰
pip3 install gunicorn
```

#### 4.2 åˆ›å»ºå¯åŠ¨è„šæœ¬
```bash
# åˆ›å»ºåŽç«¯å¯åŠ¨è„šæœ¬
cat > /var/www/email-sender/start_backend.sh << 'EOF'
#!/bin/bash
cd /var/www/email-sender/backend
gunicorn -w 2 -b 127.0.0.1:5000 app:app --daemon
echo "åŽç«¯æœåŠ¡å·²å¯åŠ¨"
EOF

chmod +x /var/www/email-sender/start_backend.sh
```

#### 4.3 é…ç½®Nginx
```bash
# åˆ›å»ºNginxé…ç½®
sudo cat > /etc/nginx/sites-available/email-sender << 'EOF'
server {
    listen 80;
    server_name your-domain.com;  # æ›¿æ¢ä¸ºæ‚¨çš„åŸŸåæˆ–IP
    
    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /var/www/email-sender/frontend/dist;
        try_files $uri $uri/ /index.html;
    }
    
    # åŽç«¯APIä»£ç†
    location /api {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶
        client_max_body_size 50M;
    }
}
EOF

# å¯ç”¨é…ç½®
sudo ln -s /etc/nginx/sites-available/email-sender /etc/nginx/sites-enabled/
sudo nginx -t  # æµ‹è¯•é…ç½®
sudo systemctl restart nginx
```

### 5. åˆ›å»ºç³»ç»ŸæœåŠ¡ï¼ˆè‡ªåŠ¨å¯åŠ¨ï¼‰

```bash
# åˆ›å»ºsystemdæœåŠ¡
sudo cat > /etc/systemd/system/email-sender.service << 'EOF'
[Unit]
Description=Email Sender Backend Service
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/var/www/email-sender/backend
ExecStart=/usr/local/bin/gunicorn -w 2 -b 127.0.0.1:5000 app:app
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF

# å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable email-sender
sudo systemctl start email-sender
sudo systemctl status email-sender
```

### 6. é…ç½®é˜²ç«å¢™

```bash
# Ubuntué˜²ç«å¢™
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp  # å¦‚æžœä½¿ç”¨HTTPS
sudo ufw enable

# CentOSé˜²ç«å¢™
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
```

### 7. è®¿é—®æµ‹è¯•

1. æµè§ˆå™¨è®¿é—®: `http://æ‚¨çš„æœåŠ¡å™¨IP`
2. å¦‚æžœæœ‰åŸŸåï¼Œè®¿é—®: `http://your-domain.com`

## ðŸ”’ å®‰å…¨åŠ å›ºï¼ˆé‡è¦ï¼ï¼‰

### 1. åŸºç¡€å®‰å…¨è®¾ç½®

```bash
# 1. åˆ›å»ºæ™®é€šç”¨æˆ·ï¼ˆä¸ä½¿ç”¨rootï¼‰
adduser emailadmin
usermod -aG sudo emailadmin

# 2. ç¦ç”¨rootç™»å½•ï¼ˆå¯é€‰ï¼‰
# ç¼–è¾‘ /etc/ssh/sshd_config
# PermitRootLogin no

# 3. ä¿®æ”¹SSHç«¯å£ï¼ˆå¯é€‰ï¼‰
# ç¼–è¾‘ /etc/ssh/sshd_config
# Port 2222
```

### 2. æ·»åŠ è®¿é—®æŽ§åˆ¶

å¦‚æžœåªç»™å‡ ä¸ªäººä½¿ç”¨ï¼Œå¯ä»¥ï¼š

#### æ–¹æ³•1: IPç™½åå•ï¼ˆæŽ¨èï¼‰
```nginx
# åœ¨Nginxé…ç½®ä¸­æ·»åŠ 
location / {
    # åªå…è®¸ç‰¹å®šIPè®¿é—®
    allow 192.168.1.100;  # ç”¨æˆ·1çš„IP
    allow 192.168.1.101;  # ç”¨æˆ·2çš„IP
    deny all;
    
    root /var/www/email-sender/frontend/dist;
    try_files $uri $uri/ /index.html;
}
```

#### æ–¹æ³•2: åŸºç¡€è®¤è¯
```bash
# åˆ›å»ºå¯†ç æ–‡ä»¶
sudo apt install apache2-utils
sudo htpasswd -c /etc/nginx/.htpasswd user1
sudo htpasswd /etc/nginx/.htpasswd user2

# åœ¨Nginxé…ç½®ä¸­æ·»åŠ 
location / {
    auth_basic "Restricted Access";
    auth_basic_user_file /etc/nginx/.htpasswd;
    
    root /var/www/email-sender/frontend/dist;
    try_files $uri $uri/ /index.html;
}
```

### 3. é…ç½®HTTPSï¼ˆæŽ¨èï¼‰

```bash
# ä½¿ç”¨Let's Encryptå…è´¹è¯ä¹¦
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

## ðŸš€ å¿«é€Ÿéƒ¨ç½²è„šæœ¬

åˆ›å»ºä¸€ä¸ªä¸€é”®éƒ¨ç½²è„šæœ¬ `deploy.sh`:

```bash
#!/bin/bash

# é…ç½®å˜é‡
SERVER_IP="your-server-ip"
PROJECT_DIR="/var/www/email-sender"

echo "å¼€å§‹éƒ¨ç½²é‚®ä»¶ç¾¤å‘åŠ©æ‰‹..."

# 1. æ›´æ–°ç³»ç»Ÿ
echo "æ›´æ–°ç³»ç»Ÿ..."
sudo apt update && sudo apt upgrade -y

# 2. å®‰è£…ä¾èµ–
echo "å®‰è£…ä¾èµ–..."
sudo apt install -y python3 python3-pip nginx nodejs npm

# 3. éƒ¨ç½²é¡¹ç›®
echo "éƒ¨ç½²é¡¹ç›®æ–‡ä»¶..."
cd $PROJECT_DIR

# 4. å®‰è£…Pythonä¾èµ–
echo "å®‰è£…åŽç«¯ä¾èµ–..."
cd backend
pip3 install -r requirements.txt
pip3 install gunicorn

# 5. æž„å»ºå‰ç«¯
echo "æž„å»ºå‰ç«¯..."
cd ../frontend
npm install
npm run build

# 6. å¯åŠ¨æœåŠ¡
echo "å¯åŠ¨æœåŠ¡..."
cd ../backend
gunicorn -w 2 -b 127.0.0.1:5000 app:app --daemon

# 7. é‡å¯Nginx
sudo systemctl restart nginx

echo "éƒ¨ç½²å®Œæˆï¼è®¿é—® http://$SERVER_IP"
```

## ðŸ“ ç»´æŠ¤æŒ‡å—

### æ—¥å¸¸ç»´æŠ¤å‘½ä»¤

```bash
# æŸ¥çœ‹åŽç«¯æ—¥å¿—
sudo journalctl -u email-sender -f

# é‡å¯åŽç«¯æœåŠ¡
sudo systemctl restart email-sender

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status email-sender

# é‡å¯Nginx
sudo systemctl restart nginx

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

### æ›´æ–°é¡¹ç›®

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /var/www/email-sender

# 2. æ›´æ–°ä»£ç ï¼ˆå¦‚æžœä½¿ç”¨gitï¼‰
git pull

# 3. æ›´æ–°ä¾èµ–ï¼ˆå¦‚æžœéœ€è¦ï¼‰
cd backend
pip3 install -r requirements.txt

# 4. é‡æ–°æž„å»ºå‰ç«¯ï¼ˆå¦‚æžœå‰ç«¯æœ‰æ›´æ–°ï¼‰
cd ../frontend
npm install
npm run build

# 5. é‡å¯æœåŠ¡
sudo systemctl restart email-sender
sudo systemctl restart nginx
```

## ðŸ’° æˆæœ¬ä¼°ç®—

### å°è§„æ¨¡ä½¿ç”¨ï¼ˆ3-5äººï¼‰
- **äº‘æœåŠ¡å™¨**: 24-50å…ƒ/æœˆ
- **åŸŸå**ï¼ˆå¯é€‰ï¼‰: 30-60å…ƒ/å¹´
- **æ€»æˆæœ¬**: çº¦300-600å…ƒ/å¹´

### èŠ‚çœæˆæœ¬æ–¹æ¡ˆ
1. ä½¿ç”¨å…¬å¸å†…ç½‘æœåŠ¡å™¨ï¼ˆå…è´¹ï¼‰
2. ä½¿ç”¨é—²ç½®ç”µè„‘åšæœåŠ¡å™¨
3. å¤šä¸ªé¡¹ç›®å…±ç”¨ä¸€å°æœåŠ¡å™¨

## â“ å¸¸è§é—®é¢˜

### Q1: è®¿é—®é€Ÿåº¦æ…¢ï¼Ÿ
- æ£€æŸ¥æœåŠ¡å™¨å¸¦å®½
- ä¼˜åŒ–å‰ç«¯èµ„æº
- ä½¿ç”¨CDNåŠ é€Ÿï¼ˆå¯é€‰ï¼‰

### Q2: ä¸Šä¼ å¤§æ–‡ä»¶å¤±è´¥ï¼Ÿ
- ä¿®æ”¹Nginxé…ç½®çš„ `client_max_body_size`
- æ£€æŸ¥æœåŠ¡å™¨ç£ç›˜ç©ºé—´

### Q3: æœåŠ¡çªç„¶åœæ­¢ï¼Ÿ
- æ£€æŸ¥æœåŠ¡å™¨å†…å­˜
- æŸ¥çœ‹é”™è¯¯æ—¥å¿—
- è®¾ç½®è‡ªåŠ¨é‡å¯

### Q4: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ
```bash
# å¤‡ä»½è„šæœ¬
tar -czf backup-$(date +%Y%m%d).tar.gz /var/www/email-sender/backend/templates /var/www/email-sender/backend/uploads
```

## ðŸŽ‰ éƒ¨ç½²å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] æœåŠ¡å™¨å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] å‰ç«¯é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] åŽç«¯APIæ­£å¸¸å“åº”
- [ ] é‚®ä»¶å‘é€åŠŸèƒ½æ­£å¸¸
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸
- [ ] è®¾ç½®äº†è®¿é—®æŽ§åˆ¶
- [ ] é…ç½®äº†è‡ªåŠ¨å¯åŠ¨
- [ ] åˆ›å»ºäº†å¤‡ä»½è®¡åˆ’

## ðŸ“ž éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æžœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—
2. ç¡®è®¤é˜²ç«å¢™è®¾ç½®
3. éªŒè¯æ‰€æœ‰æœåŠ¡éƒ½åœ¨è¿è¡Œ
4. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„å¸¸è§é—®é¢˜éƒ¨åˆ†

ç¥æ‚¨éƒ¨ç½²é¡ºåˆ©ï¼ðŸš€
