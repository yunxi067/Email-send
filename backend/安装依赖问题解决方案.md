# 依赖安装问题解决方案

## 问题诊断

您当前使用的是 **Python 3.13**，但pandas 2.1.3不支持Python 3.13。

## 解决方案（3个选择）

### 方案一：使用Python 3.11或3.12（推荐✅）

这是最简单且最稳定的方案。

1. **卸载Python 3.13**
   - Windows设置 → 应用 → 卸载Python 3.13

2. **安装Python 3.11或3.12**
   - 下载地址：https://www.python.org/downloads/
   - 推荐版本：**Python 3.11.9** 或 **Python 3.12.4**
   - 安装时勾选"Add Python to PATH"

3. **重新安装依赖**
   ```bash
   cd backend
   pip install -r requirements.txt
   ```

### 方案二：升级包版本（适用于Python 3.13）

使用更新的包版本来支持Python 3.13。

```bash
cd backend
pip install -r requirements-py313.txt
```

或者手动安装：
```bash
pip install Flask flask-cors pandas openpyxl xlrd Werkzeug --upgrade
```

### 方案三：使用预编译包（快速解决）

使用清华镜像的预编译包：

```bash
cd backend
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple Flask flask-cors pandas openpyxl xlrd Werkzeug
```

或者使用conda（如果已安装）：
```bash
conda create -n emailer python=3.11
conda activate emailer
pip install -r requirements.txt
```

## 推荐方案对比

| 方案 | 难度 | 稳定性 | 推荐度 |
|------|------|--------|--------|
| 方案一：重装Python 3.11/3.12 | ⭐⭐ | ⭐⭐⭐⭐⭐ | ✅✅✅ 强烈推荐 |
| 方案二：升级包版本 | ⭐ | ⭐⭐⭐⭐ | ✅✅ 推荐 |
| 方案三：使用镜像 | ⭐ | ⭐⭐⭐ | ✅ 可尝试 |

## 验证安装

安装完成后，验证：

```bash
python --version
# 应该显示: Python 3.11.x 或 3.12.x

pip list | findstr pandas
# 应该显示: pandas 版本号

python -c "import flask, pandas; print('安装成功！')"
# 应该显示: 安装成功！
```

## 为什么推荐Python 3.11/3.12？

1. ✅ **最佳兼容性** - 所有包都完美支持
2. ✅ **稳定性高** - 经过充分测试
3. ✅ **性能优秀** - Python 3.11有显著性能提升
4. ✅ **生态成熟** - 大部分库都支持
5. ⚠️ Python 3.13太新（2024年10月发布），很多库还未完全适配

## 快速命令（复制粘贴）

### 如果重装了Python 3.11/3.12
```bash
cd D:\common\develop\jiedna\邮件群发助手\backend
pip install Flask flask-cors pandas openpyxl xlrd Werkzeug
python app.py
```

### 如果继续使用Python 3.13
```bash
cd D:\common\develop\jiedna\邮件群发助手\backend
pip install --upgrade Flask flask-cors pandas openpyxl xlrd Werkzeug numpy
python app.py
```

### 使用国内镜像加速
```bash
cd D:\common\develop\jiedna\邮件群发助手\backend
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple Flask flask-cors pandas openpyxl xlrd Werkzeug
python app.py
```

## 常见错误处理

### 错误1: "NumPy requires GCC >= 8.4"
**解决**: 使用预编译的wheel包
```bash
pip install --only-binary :all: numpy pandas
```

### 错误2: "No module named '_ctypes'"
**解决**: 重装Python，确保勾选所有组件

### 错误3: pip版本过旧
**解决**: 先升级pip
```bash
python -m pip install --upgrade pip
```

### 错误4: 网络超时
**解决**: 使用国内镜像
```bash
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
```

## 还是不行？尝试虚拟环境

创建独立的虚拟环境（推荐）：

```bash
# 1. 创建虚拟环境
cd D:\common\develop\jiedna\邮件群发助手\backend
python -m venv venv

# 2. 激活虚拟环境
venv\Scripts\activate

# 3. 安装依赖
pip install Flask flask-cors pandas openpyxl xlrd Werkzeug

# 4. 运行
python app.py
```

## 联系支持

如果以上方案都无法解决，请提供：
1. Python版本：`python --version`
2. 操作系统版本
3. 完整错误信息

---

**建议**: 卸载Python 3.13，安装Python 3.11.9，这是目前最稳定的选择。

