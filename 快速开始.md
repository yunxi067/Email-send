# 🚀 快速开始指南

> 5分钟快速上手邮件群发助手

## ⚡ 第一步：准备环境

### Windows用户

#### 1. 安装Python
1. 访问 https://www.python.org/downloads/
2. 下载Python 3.8+版本
3. 安装时勾选"Add Python to PATH"
4. 验证安装：打开命令提示符，输入 `python --version`

#### 2. 安装Node.js
1. 访问 https://nodejs.org/
2. 下载LTS版本（推荐16+）
3. 按默认选项安装
4. 验证安装：打开命令提示符，输入 `node --version`

## 🎯 第二步：启动服务

### 方法一：使用启动脚本（推荐）

1. **启动后端**
   - 双击 `start_backend.bat`
   - 等待依赖安装完成
   - 看到"Running on http://0.0.0.0:5000"表示成功

2. **启动前端**（新开一个窗口）
   - 双击 `start_frontend.bat`
   - 等待依赖安装完成
   - 自动打开浏览器

### 方法二：手动启动

#### 启动后端
```bash
cd backend
pip install -r requirements.txt
python app.py
```

#### 启动前端（新开终端）
```bash
cd frontend
npm install
npm run dev
```

### 🔄 停止和重启服务

#### 停止服务

**后端服务：**
- 在后端运行窗口按 `Ctrl + C`
- 等待提示"Press any key to continue..."
- 按任意键关闭窗口

**前端服务：**
- 在前端运行窗口按 `Ctrl + C`
- 输入 `Y` 确认终止
- 关闭窗口

#### 重启服务

**方法一：使用启动脚本重启**
```bash
# 后端重启
1. 先停止后端服务（Ctrl + C）
2. 再次双击 start_backend.bat

# 前端重启
1. 先停止前端服务（Ctrl + C）
2. 再次双击 start_frontend.bat
```

**方法二：命令行重启**
```bash
# 后端重启
cd D:\common\develop\jiedna\邮件群发助手\backend
python app.py

# 前端重启（新开终端）
cd D:\common\develop\jiedna\邮件群发助手\frontend
npm run dev
```

**快捷重启命令（已安装依赖后）：**

后端重启：
```bash
cd backend && python app.py
```

前端重启：
```bash
cd frontend && npm run dev
```

#### 常见场景

**场景1：修改了后端代码**
- 按 `Ctrl + C` 停止后端
- 重新运行 `python app.py`
- 前端无需重启

**场景2：修改了前端代码**
- Vite支持热更新，保存后自动刷新
- 无需手动重启
- 如果页面没更新，按 `F5` 刷新浏览器

**场景3：修改了配置文件**
- 后端：需要重启后端服务
- 前端：需要重启前端服务（如修改了vite.config.ts）

**场景4：遇到端口占用**
```bash
# 查看端口占用（Windows）
netstat -ano | findstr :5000    # 后端端口
netstat -ano | findstr :3000    # 前端端口

# 结束占用端口的进程
taskkill /PID <进程ID> /F
```

#### 服务状态检查

**检查后端是否运行：**
```bash
# 浏览器访问
http://localhost:5000/api/health

# 或使用curl（需安装）
curl http://localhost:5000/api/health
```

**检查前端是否运行：**
```bash
# 浏览器访问
http://localhost:3000
```

#### 完全停止所有服务
```bash
1. 后端窗口：Ctrl + C
2. 前端窗口：Ctrl + C → 输入 Y
3. 关闭所有相关命令提示符窗口
4. （可选）检查进程是否完全停止
```

## 📧 第三步：配置SMTP

### QQ邮箱配置示例

1. **获取授权码**
   - 登录QQ邮箱网页版
   - 设置 → 账户 → POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务
   - 开启"SMTP服务"
   - 生成授权码（保存好，只显示一次）

2. **填写配置**
   ```
   SMTP服务器: smtp.qq.com
   端口: 465
   发件人邮箱: your@qq.com
   发件人姓名: 您的名字
   密码: 刚才生成的授权码（不是QQ密码）
   使用SSL: 开启
   ```

3. **点击"测试连接"**
   - 如果显示"SMTP连接测试成功！"，说明配置正确

### 其他邮箱配置

#### 163邮箱
```
服务器: smtp.163.com
端口: 465
密码: 使用授权码（在设置中获取）
SSL: 开启
```

#### 中国移动邮箱（139邮箱）
```
服务器: smtp.139.com
端口: 465 或 25
密码: 使用邮箱密码或客户端授权码
SSL: 端口465时开启，端口25时关闭
```

**配置步骤：**
1. 登录139邮箱网页版
2. 设置 → 邮箱设置 → POP3/SMTP服务
3. 开启SMTP服务
4. 如需授权码，生成客户端授权码
5. 使用邮箱密码或授权码登录

#### Gmail
```
服务器: smtp.gmail.com
端口: 465
密码: 使用应用专用密码
SSL: 开启
注意: 需要开启两步验证
```

## 📊 第四步：准备收件人列表

### 使用示例文件

1. 打开 `examples/recipients.csv`
2. 复制并修改为你的收件人信息：

```csv
email,name,attachment
zhang@example.com,张三,
li@example.com,李四,
wang@example.com,王五,
```

### Excel格式说明

**必需列：**
- `email` - 收件人邮箱
- `name` - 收件人姓名

**可选列：**
- `attachment` - 附件路径

### 使用Excel创建

1. 打开Microsoft Excel或WPS
2. 第一行输入列名：`email`, `name`, `attachment`
3. 从第二行开始填写数据
4. 保存为 `.xlsx` 或 `.csv` 格式

## ✉️ 第五步：编写邮件

### 基础邮件

**主题：**
```
测试邮件
```

**内容：**
```
尊敬的{{name}}：

您好！这是一封测试邮件。

您的邮箱是：{{email}}

此致
敬礼
```

### 个性化变量

- `{{name}}` - 自动替换为收件人姓名
- `{{email}}` - 自动替换为收件人邮箱

### HTML邮件

开启"HTML模式"后，可以使用HTML标签：

```html
<h2>尊敬的{{name}}：</h2>

<p>您好！这是一封<strong>HTML格式</strong>的测试邮件。</p>

<ul>
  <li>您的邮箱：{{email}}</li>
  <li>发送时间：2024年10月9日</li>
</ul>

<p style="color: blue;">祝您工作顺利！</p>
```

## 📎 第六步：添加附件

### 方法一：统一附件

在"编写邮件"步骤中：
1. 点击"上传附件"按钮
2. 选择要发送的文件
3. 所有收件人都会收到此附件

### 方法二：个性化附件

1. 将附件文件放入 `backend/attachments/` 文件夹
2. 在Excel的`attachment`列填写文件名
3. 不同收件人会收到不同附件

**示例：**
```csv
email,name,attachment
zhang@example.com,张三,contract_zhang.pdf
li@example.com,李四,contract_li.pdf
wang@example.com,王五,contract_wang.pdf
```

## 🎉 第七步：发送邮件

1. 点击"开始发送"按钮
2. 等待发送完成
3. 查看发送结果：
   - ✅ 绿色：发送成功
   - ❌ 红色：发送失败（查看错误信息）

### 发送建议

- 首次使用先发送给自己测试
- 确认格式正确后再批量发送
- 大量邮件建议分批发送（每批50-100封）
- 注意邮件服务商的发送频率限制

## ⚠️ 常见问题

### 1. 连接失败
**可能原因：**
- SMTP配置错误
- 使用了登录密码而非授权码
- 网络问题
- 防火墙拦截

**解决方法：**
- 检查SMTP地址和端口
- 使用授权码（不是登录密码）
- 尝试切换SSL/TLS
- 关闭防火墙测试

### 2. Excel解析失败
**可能原因：**
- 缺少必需的列（email或name）
- 列名拼写错误
- 文件格式不支持

**解决方法：**
- 确保包含`email`和`name`列
- 检查列名大小写
- 使用.xlsx、.xls或.csv格式

### 3. 发送失败
**可能原因：**
- 收件人邮箱地址错误
- 附件过大
- 发送频率过快
- SMTP服务器限制

**解决方法：**
- 检查邮箱地址格式
- 减小附件大小（<25MB）
- 降低发送速度
- 联系邮箱服务商

### 4. 依赖安装失败

**Python依赖问题：**
```bash
# 使用清华镜像
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt
```

**Node.js依赖问题：**
```bash
# 使用淘宝镜像
npm config set registry https://registry.npmmirror.com
npm install
```

### 5. 端口被占用

**修改后端端口：**
编辑 `backend/app.py` 最后一行：
```python
app.run(host='0.0.0.0', port=5001, debug=True)  # 改为5001
```

**修改前端端口：**
编辑 `frontend/vite.config.ts`：
```typescript
server: {
  port: 3001,  // 改为3001
  // ...
}
```

## 📝 使用检查清单

在开始发送前，请确认：

- [ ] ✅ Python和Node.js已安装
- [ ] ✅ 后端服务已启动（localhost:5000）
- [ ] ✅ 前端服务已启动（localhost:3000）
- [ ] ✅ SMTP配置已测试通过
- [ ] ✅ Excel文件格式正确
- [ ] ✅ 收件人信息已核对
- [ ] ✅ 邮件内容已检查
- [ ] ✅ 已发送测试邮件验证
- [ ] ✅ 确认收件人同意接收

## 🎓 进阶技巧

### 1. 批量测试
先创建只包含你自己邮箱的测试文件：
```csv
email,name,attachment
mytest@qq.com,测试1,
mytest@qq.com,测试2,
mytest@qq.com,测试3,
```

### 2. 发送时间控制
如果需要在特定时间发送，可以设置系统定时任务：
- Windows: 使用"任务计划程序"
- Linux/Mac: 使用cron

### 3. 日志记录
后端控制台会显示详细日志，建议保存：
```bash
python app.py > log.txt 2>&1
```

### 4. 性能优化
大量邮件建议分批发送：
- 每批50-100封
- 批次间隔5-10分钟
- 避免邮箱服务商限流

## 📞 获取帮助

1. 查看详细文档：`README.md`
2. 查看项目结构：`项目结构.md`
3. 查看示例说明：`examples/README.md`
4. 查看启动说明：`启动说明.txt`

## 🎊 开始使用

现在你已经准备好了！

1. 🔧 启动服务
2. ⚙️ 配置SMTP
3. 📊 导入收件人
4. ✉️ 编写邮件
5. 🚀 开始发送

祝你使用愉快！🎉

## 🛠️ 服务管理速查表

### 启动服务
| 方式 | 后端 | 前端 |
|------|------|------|
| 脚本 | 双击 `start_backend.bat` | 双击 `start_frontend.bat` |
| 命令 | `cd backend && python app.py` | `cd frontend && npm run dev` |

### 停止服务
| 操作 | 后端 | 前端 |
|------|------|------|
| 停止 | `Ctrl + C` | `Ctrl + C` → `Y` |

### 重启服务
| 方式 | 说明 |
|------|------|
| 重启后端 | 停止后端 → 重新运行启动脚本 |
| 重启前端 | 停止前端 → 重新运行启动脚本 |

### 检查状态
| 服务 | 检查方式 |
|------|----------|
| 后端 | 访问 http://localhost:5000/api/health |
| 前端 | 访问 http://localhost:3000 |

### 端口说明
| 服务 | 默认端口 | 修改位置 |
|------|----------|----------|
| 后端 | 5000 | `backend/app.py` 最后一行 |
| 前端 | 3000 | `frontend/vite.config.ts` |

### 常用命令备忘
```bash
# 进入项目目录
cd D:\common\develop\jiedna\邮件群发助手

# 后端快速启动
cd backend
python app.py

# 前端快速启动（新开终端）
cd frontend
npm run dev

# 查看Python版本
python --version

# 查看Node版本
node --version

# 更新pip
python -m pip install --upgrade pip

# 清理npm缓存（前端问题时）
cd frontend
npm cache clean --force
rm -rf node_modules
npm install
```

---

**提示：** 如果遇到问题，请先查看"常见问题"部分，大多数问题都能找到解决方案。

